# hmJavaVM プロジェクトの問題点分析

このドキュメントは、`hmJavaVM` プロジェクトの現状と、メンテナンスや将来的な開発における潜在的な問題点をまとめたものです。

---

## 1. プロジェクトが非推奨 (Deprecated) である

- **内容**: `README.md` に明記されている通り、このプロジェクトは開発者によって **非推奨** とされています。
- **原因**: Java 9以降のクラスローダーの仕組みの変更や、Oracle社のライセンス体系の変更に対応することが困難であるためです。
- **影響**: 最大の問題点であり、このままでは将来的なJavaバージョンでの動作は絶望的です。セキュリティリスクやパフォーマンスの観点からも、新しい環境への対応は必須ですが、それが見込めない状態です。

## 2. 脆弱で複雑なビルドプロセス

プロジェクトはC++ (DLL) と Java (JAR) の2つの要素から構成されていますが、どちらのビルドプロセスも現代的な開発手法とは言えず、多くの問題を抱えています。

### a. C++ (DLL) のビルド

- **古いIDEへの依存**: ビルドには **Visual Studio 2017** が必要です。新しい開発環境への移行が困難です。
- **ハードコードされた絶対パス**: `.vcxproj` ファイル内に、開発者のローカル環境に存在する特定のJDKへの絶対パス (例: `C:\Program Files\Java\jdk1.8.0_333\`) がハードコードされています。これにより、他の開発者が環境を構築する際に、プロジェクトファイル自体を手動で修正する必要があり、ポータビリティが著しく低いです。

### b. Java (JAR) のビルド

- **手動ビルド**: `javac` と `jar` コマンドを手動で実行する必要があります。手順は `.txt` ファイルに記載されているのみで、MavenやGradleのような自動ビルドツールが導入されていません。
- **ヒューマンエラーの誘発**: ビルドプロセスが自動化されていないため、手順ミスや環境差異によるエラーが発生しやすいです。

## 3. 不適切な依存関係管理

- **ライブラリソースの直接混入**: C++側では、XML解析ライブラリである `TinyXML` のソースコードが直接プロジェクトにコピー＆ペーストされています。Git Submoduleやvcpkg、NuGetのようなパッケージマネージャーが使われておらず、ライブラリのバージョン管理やアップデートが非常に困難です。

## 4. 文字コードの混在

- **Shift-JISエンコーディング**: C++やJavaのソースコード、設定ファイルのコメント部分などがShift-JISで記述されています。これにより、UTF-8が主流である現代の開発環境では文字化けが発生し、コードの可読性を下げています。

## 5. 自動テストの欠如

- **テストコードが存在しない**: JUnit (Java) やGoogle Test (C++) のようなテストフレームワークが導入されておらず、単体テストや結合テストのコードが見当たりません。
- **リファクタリングの困難**: テストがないため、バグ修正や機能追加、リファクタリングを行った際に、意図しない副作用（リグレッション）が発生しても検知することができません。コードの変更が非常にリスキーな状態です。

## 6. ビルド成果物のバージョン管理

- **バイナリファイルの混入**: `.dll`, `.jar`, `.obj` といった、ビルドによって生成されるべき中間ファイルや最終成果物がGitのリポジトリにコミットされています。
- **リポジトリの肥大化**: これらのバイナリファイルはリポジトリサイズを不必要に増大させます。本来、`.gitignore` で除外すべきです。

## 7. プラットフォームへの強い依存

- **Windows専用**: Visual Studio と DLL を利用しているため、現状ではWindows環境でしかビルド・実行ができません。

## 8. 非推奨のJava機能の使用

- **古いJava APIの使用**: `javac` のコンパイルオプションに `-Xlint:deprecation` が指定されていることや、ソースコード内でリフレクションを用いてクラスパスを操作する (`URLClassLoader.addURL`) など、Java 8の時点ですでに古くなっていたり、Java 9以降では動作しないAPIに依存しています。
